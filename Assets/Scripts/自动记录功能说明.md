# 🔄 自动记录功能使用说明

## 功能概述

自动记录功能是为了简化设计师的工作流程而设计的智能系统。当设计师在Scene视图中拖动UI组件时，系统会自动将变化记录到当前平台的对应属性数据中，无需手动在Inspector中输入数据。

## 核心特性

### ✨ 智能检测
- **实时监控**: 系统持续监控RectTransform的所有属性变化
- **选择性记录**: 只记录已启用的属性（位置、尺寸、锚点、轴心、旋转、缩放）
- **平台感知**: 自动保存到当前激活的平台

### ⏱️ 延迟保存机制
- **防抖动**: 设置0.5秒的默认延迟，避免拖动过程中频繁保存
- **性能优化**: 减少不必要的序列化操作
- **用户友好**: 等待用户完成调整后再保存

### 🎯 精确控制
- **属性过滤**: 根据"Enabled Properties"设置决定哪些属性参与自动记录
- **平台隔离**: 每个平台的数据独立存储，互不影响
- **即时反馈**: 控制台显示自动保存的详细信息

## 使用方法

### 1. 启用自动记录
1. 选择带有`MultiPlatformRectData`组件的UI对象
2. 在Inspector的"🔄 自动记录设置"区域
3. 勾选"启用自动记录"选项

### 2. 配置记录延迟
- 调整"记录延迟(秒)"参数（默认0.5秒）
- 较短的延迟：更快的响应，但可能频繁保存
- 较长的延迟：减少保存频率，但响应稍慢

### 3. 设置要记录的属性
在"属性配置"区域启用需要自动记录的属性：
- ✅ **启用位置覆盖**: 记录anchoredPosition变化
- ✅ **启用尺寸覆盖**: 记录sizeDelta变化
- ✅ **启用锚点覆盖**: 记录anchorMin/anchorMax变化
- ⬜ **启用轴心覆盖**: 记录pivot变化
- ⬜ **启用旋转覆盖**: 记录rotation变化
- ✅ **启用缩放覆盖**: 记录scale变化

### 4. 开始设计工作
1. 切换到目标平台（PC/PS5/Android/iOS）
2. 在Scene视图中直接拖动UI组件
3. 系统会自动检测变化并延迟保存
4. 查看控制台确认保存成功

## 工作流程示例

### 多平台UI适配流程
```
1. 切换到PC平台 (Ctrl+1)
   └── 在Scene中调整UI布局
   └── 系统自动保存PC平台数据

2. 切换到Android平台 (Ctrl+3)
   └── 在Scene中调整UI布局
   └── 系统自动保存Android平台数据

3. 切换到iOS平台 (Ctrl+4)
   └── 在Scene中调整UI布局
   └── 系统自动保存iOS平台数据

4. 测试切换效果
   └── 使用快捷键在平台间切换
   └── 观察UI自动应用对应设置
```

## 技术实现细节

### 变化检测机制
```csharp
// 系统监控的属性
- lastAnchoredPosition  // 上次记录的位置
- lastSizeDelta        // 上次记录的尺寸
- lastAnchorMin/Max    // 上次记录的锚点
- lastPivot           // 上次记录的轴心
- lastRotation        // 上次记录的旋转
- lastScale           // 上次记录的缩放
```

### 保存触发条件
1. **属性变化**: 检测到启用属性的数值变化
2. **延迟满足**: 距离最后一次变化超过设定延迟时间
3. **平台有效**: PlatformManager.Instance存在且正常
4. **编辑器模式**: 只在Unity编辑器中工作

### 数据存储结构
```csharp
// 每个平台独立存储
Platform.PC -> PlatformRectSettings
Platform.PS5 -> PlatformRectSettings
Platform.Android -> PlatformRectSettings
Platform.iOS -> PlatformRectSettings
```

## 注意事项

### ⚠️ 重要提醒
1. **编辑器专用**: 自动记录功能只在Unity编辑器中工作
2. **性能考虑**: 在Update中检测变化，建议合理设置延迟时间
3. **数据持久化**: 记得保存场景以持久化自动记录的数据

### 🔧 故障排除
- **自动记录不工作**: 检查是否启用了自动记录选项
- **保存频率过高**: 增加记录延迟时间
- **某些属性未记录**: 确认对应的"Enabled Properties"已勾选
- **平台数据丢失**: 检查PlatformManager是否正常工作

## 最佳实践

### 🎨 设计师工作流程
1. **规划阶段**: 先确定需要适配的平台和属性
2. **基础布局**: 在主平台（如PC）完成基础UI布局
3. **平台适配**: 逐个切换平台，调整特定的UI元素
4. **测试验证**: 频繁切换平台测试适配效果
5. **最终检查**: 确保所有平台的UI都符合设计要求

### 💡 效率提升技巧
- 使用快捷键快速切换平台
- 合理配置启用属性，避免不必要的数据记录
- 利用控制台日志确认自动保存状态
- 定期保存场景以防数据丢失

## 与其他功能的配合

### 🎮 平台切换系统
- 自动记录与平台切换完美配合
- 切换平台时自动应用对应设置
- 在当前平台的调整会自动保存

### 🔧 手动操作
- 仍可使用"保存当前设置"按钮手动保存
- 仍可使用"应用平台设置"按钮手动应用
- 自动记录与手动操作互不冲突

这个自动记录功能将大大提升多平台UI设计的效率，让设计师能够专注于创意和用户体验，而不是繁琐的数据输入工作。