# 平台实时预览功能使用指南

## 概述

这个增强的平台预览系统允许你在Unity Editor中实时切换平台并立即看到UI组件的变化效果。当你在不同平台之间切换时，所有配置了MultiPlatformRectData的UI组件会自动调整其位置、尺寸、锚点等属性。

## 核心功能

### 🎮 实时平台切换
- **即时生效**: 切换平台时，Scene视图中的UI组件立即更新
- **全局同步**: 所有MultiPlatformRectData组件同时响应平台变化
- **可视化反馈**: Scene视图覆盖层显示当前平台状态

### 📱 多种操作方式

#### 1. RectTransform Inspector面板
- 在任何RectTransform的Inspector中都有平台切换按钮
- 支持快捷键：Ctrl+1(PC), Ctrl+2(PS5), Ctrl+3(Android), Ctrl+4(iOS)
- 当前平台用绿色高亮显示

#### 2. 平台预览窗口 (Window > Platform Preview)
- 专门的预览工具窗口
- 下拉菜单选择平台
- 快速切换按钮
- 组件统计和管理
- 调试信息显示

#### 3. Scene视图覆盖层
- 在Scene视图左上角显示当前平台信息
- 快速切换按钮直接在Scene视图中操作
- 选中组件时显示详细信息
- 一键刷新所有组件

## 使用步骤

### 1. 基础设置
1. 确保场景中有PlatformManager组件
2. 为需要平台适配的UI组件添加MultiPlatformRectData组件
3. 配置每个组件需要覆盖的属性（位置、尺寸、锚点等）

### 2. 配置平台设置
1. 选择要配置的UI组件
2. 在RectTransform Inspector中切换到目标平台
3. 调整UI组件的属性（在Scene视图中拖拽或在Inspector中修改）
4. 点击"保存当前设置"按钮保存到当前平台

### 3. 实时预览
1. 使用任意方式切换平台：
   - Inspector面板的平台按钮
   - 快捷键 Ctrl+1/2/3/4
   - 平台预览窗口
   - Scene视图覆盖层按钮
2. 观察Scene视图中UI组件的实时变化
3. 可以在不同平台间快速切换对比效果

## 高级功能

### 🔄 自动记录功能
- 启用后，在Scene视图中拖拽UI组件时自动保存到当前平台
- 可设置记录延迟，避免频繁保存
- 只保存已启用的属性

### 📊 批量管理
- 平台预览窗口显示所有MultiPlatformRectData组件
- 可以批量刷新所有组件
- 支持单独选择和应用组件设置

### 🔍 调试工具
- Scene视图覆盖层显示组件数量
- 选中组件时显示详细的平台设置信息
- 平台预览窗口的调试模式显示所有组件列表

## 最佳实践

### 1. 工作流程建议
1. **设计阶段**: 先在PC平台设计基础布局
2. **适配阶段**: 逐个切换到其他平台进行适配
3. **测试阶段**: 使用快速切换功能验证各平台效果
4. **优化阶段**: 使用调试工具检查和优化设置

### 2. 性能优化
- 只为真正需要平台差异的UI组件添加MultiPlatformRectData
- 只启用需要覆盖的属性，避免不必要的计算
- 使用二进制存储模式减少内存占用

### 3. 团队协作
- 统一使用相同的平台切换方式
- 定期检查平台设置的一致性
- 使用版本控制管理平台配置

## 快捷键参考

| 快捷键 | 功能 |
|--------|------|
| Ctrl+1 | 切换到PC平台 |
| Ctrl+2 | 切换到PS5平台 |
| Ctrl+3 | 切换到Android平台 |
| Ctrl+4 | 切换到iOS平台 |

## 故障排除

### 常见问题

**Q: 切换平台后UI组件没有变化？**
A: 检查以下几点：
- 确保组件已添加MultiPlatformRectData
- 确认已为目标平台保存过设置
- 检查相关属性是否已启用覆盖

**Q: Scene视图覆盖层不显示？**
A: 重新编译脚本或重启Unity Editor

**Q: 快捷键不工作？**
A: 确保RectTransform Inspector面板处于焦点状态

### 调试步骤
1. 打开平台预览窗口检查组件数量
2. 使用调试模式查看组件详情
3. 检查Console中的日志信息
4. 验证PlatformManager是否正常工作

## 技术细节

### 实现原理
- 使用观察者模式响应平台变化
- Editor扩展提供实时预览功能
- Scene视图覆盖层使用OnSceneGUI回调
- 自动标记对象为Dirty确保保存

### 扩展性
- 可以添加新的平台类型
- 支持自定义属性覆盖
- 可以集成到自定义Editor工具中

这个系统为Unity多平台UI开发提供了强大而直观的预览和管理功能，大大提高了开发效率和设计精度。